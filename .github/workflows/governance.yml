name: Governance Check

on:
  pull_request:
    types: [opened, edited, synchronize, reopened]

jobs:
  governance-check:
    runs-on: ubuntu-latest
    steps:
      - name: Validate PR body references issue
        run: |
          python - <<'PY'
          import json
          import os
          import re
          import sys

          event_path = os.environ["GITHUB_EVENT_PATH"]

          with open(event_path, "r", encoding="utf-8") as f:
              event = json.load(f)

          body = (event.get("pull_request") or {}).get("body") or ""

          if not re.search(r"Closes #[0-9]+", body):
              print("Missing Closes #<IssueID> reference")
              sys.exit(1)
          PY
